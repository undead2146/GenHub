<Styles xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <Design.PreviewWith>
        <Border Padding="40" Background="#1E1E1E">
            <StackPanel Spacing="20">
                <ComboBox PlaceholderText="Select an option" Width="200">
                    <ComboBoxItem>Option 1</ComboBoxItem>
                    <ComboBoxItem>Option 2</ComboBoxItem>
                    <ComboBoxItem>Option 3</ComboBoxItem>
                </ComboBox>
                <ComboBox IsEnabled="False" PlaceholderText="Disabled" Width="200" />
            </StackPanel>
        </Border>
    </Design.PreviewWith>

    <Style Selector="ComboBox">
        <Setter Property="Background" Value="#333333" />
        <Setter Property="Foreground" Value="#E0E0E0" />
        <Setter Property="BorderBrush" Value="#444444" />
        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="CornerRadius" Value="3" />
        <Setter Property="Padding" Value="12,8" />
        <Setter Property="HorizontalAlignment" Value="Stretch" />
        <Setter Property="VerticalAlignment" Value="Center" />
        <Setter Property="MinHeight" Value="36" />
        <Setter Property="PlaceholderForeground" Value="#999999" />
        <Setter Property="Template">
            <ControlTemplate>
                <Grid ColumnDefinitions="*,36">
                    <Border x:Name="Background"
                            Grid.Column="0"
                            Grid.ColumnSpan="2"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            CornerRadius="{TemplateBinding CornerRadius}" />

                    <TextBlock x:Name="PlaceholderTextBlock"
                               Grid.Column="0"
                               Margin="{TemplateBinding Padding}"
                               HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                               VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                               Foreground="{TemplateBinding PlaceholderForeground}"
                               IsVisible="{TemplateBinding SelectionBoxItem, Converter={x:Static ObjectConverters.IsNull}}"
                               Text="{TemplateBinding PlaceholderText}" />

                    <ContentPresenter x:Name="ContentPresenter"
                                      Grid.Column="0"
                                      Margin="{TemplateBinding Padding}"
                                      HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                      VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                      Content="{TemplateBinding SelectionBoxItem}"
                                      ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}" />

                    <PathIcon x:Name="DropDownGlyph"
                              Grid.Column="1"
                              Width="10"
                              Height="10"
                              Margin="0,0,12,0"
                              HorizontalAlignment="Right"
                              VerticalAlignment="Center"
                              Data="M7,10L12,15L17,10H7Z"
                              Foreground="#CCCCCC"
                              UseLayoutRounding="False" />

                    <Popup x:Name="PART_Popup"
                           Grid.Column="0"
                           WindowManagerAddShadowHint="True"
                           Width="{Binding #Background.Bounds.Width}"
                           MaxHeight="{TemplateBinding MaxDropDownHeight}"
                           IsLightDismissEnabled="True"
                           IsOpen="{TemplateBinding IsDropDownOpen, Mode=TwoWay}"
                           PlacementTarget="{TemplateBinding}">
                        <Border x:Name="PopupBorder"
                                Background="#2D2D30"
                                BorderBrush="#444444"
                                BorderThickness="1"
                                CornerRadius="3"
                                Padding="2">
                            <ScrollViewer HorizontalScrollBarVisibility="{TemplateBinding ScrollViewer.HorizontalScrollBarVisibility}"
                                          VerticalScrollBarVisibility="{TemplateBinding ScrollViewer.VerticalScrollBarVisibility}">
                                <ItemsPresenter x:Name="PART_ItemsPresenter"
                                                ItemsPanel="{TemplateBinding ItemsPanel}" />
                            </ScrollViewer>
                        </Border>
                    </Popup>
                </Grid>
            </ControlTemplate>
        </Setter>
    </Style>

    <!-- Hover State -->
    <Style Selector="ComboBox:pointerover /template/ Border#Background">
        <Setter Property="Background" Value="#3E3E42" />
        <Setter Property="BorderBrush" Value="#555555" />
    </Style>

    <Style Selector="ComboBox:pointerover /template/ PathIcon#DropDownGlyph">
        <Setter Property="Foreground" Value="#FFFFFF" />
    </Style>

    <!-- Focus State -->
    <Style Selector="ComboBox:focus /template/ Border#Background">
        <Setter Property="BorderBrush" Value="{DynamicResource SystemAccentColor}" />
    </Style>

    <Style Selector="ComboBox:focus /template/ PathIcon#DropDownGlyph">
        <Setter Property="Foreground" Value="{DynamicResource SystemAccentColor}" />
    </Style>

    <!-- Open State -->
    <Style Selector="ComboBox[IsDropDownOpen=true] /template/ Border#Background">
        <Setter Property="BorderBrush" Value="{DynamicResource SystemAccentColor}" />
        <Setter Property="Background" Value="#3E3E42" />
    </Style>

    <Style Selector="ComboBox[IsDropDownOpen=true] /template/ PathIcon#DropDownGlyph">
        <Setter Property="Foreground" Value="{DynamicResource SystemAccentColor}" />
        <!-- Simple flip, no animation -->
        <Setter Property="RenderTransform" Value="rotate(180deg)" />
    </Style>

    <!-- Disabled State -->
    <Style Selector="ComboBox:disabled">
        <Setter Property="Opacity" Value="0.5" />
    </Style>

    <!-- ComboBoxItem Styles -->
    <Style Selector="ComboBoxItem">
        <Setter Property="Padding" Value="12,8" />
        <Setter Property="HorizontalAlignment" Value="Stretch" />
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="Foreground" Value="#F0F0F0" />
        <Setter Property="Margin" Value="0" />
        <Setter Property="CornerRadius" Value="2" />
    </Style>

    <Style Selector="ComboBoxItem:pointerover /template/ ContentPresenter">
        <Setter Property="Background" Value="#3E3E42" />
    </Style>

    <Style Selector="ComboBoxItem:selected /template/ ContentPresenter">
        <Setter Property="Background" Value="{DynamicResource SystemAccentColor}" />
        <Setter Property="Foreground" Value="#FFFFFF" />
    </Style>

    <Style Selector="ComboBoxItem:selected:pointerover /template/ ContentPresenter">
        <Setter Property="Background" Value="#A07C4DFF" />
    </Style>
</Styles>
